{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://ssi-protocol.org/schemas/chain-proof.json",
  "title": "SSI Chain Proof",
  "description": "Cryptographic proof of hash chain integrity for independent verification. Enables third parties to verify decision provenance without trusting the operator.",
  "type": "object",
  "required": [
    "chain_id",
    "genesis_hash",
    "current_head",
    "record_count",
    "verification_timestamp",
    "integrity_status"
  ],
  "properties": {
    "chain_id": {
      "type": "string",
      "description": "Unique identifier for this hash chain. Typically corresponds to a system deployment or audit scope.",
      "pattern": "^[a-zA-Z0-9_-]{8,64}$",
      "examples": ["chain_prod_2025", "audit-scope-healthcare-Q4"]
    },
    "genesis_hash": {
      "type": "string",
      "description": "SHA-256 hash of the genesis record (first record in chain). Known initialization hash defined in AUDIT.md.",
      "pattern": "^[a-f0-9]{64}$",
      "examples": ["0000000000000000000000000000000000000000000000000000000000000000"]
    },
    "current_head": {
      "type": "string",
      "description": "SHA-256 hash of the most recent record in the chain at verification time.",
      "pattern": "^[a-f0-9]{64}$",
      "examples": ["a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456"]
    },
    "record_count": {
      "type": "integer",
      "description": "Total number of records in the chain from genesis to current head.",
      "minimum": 0,
      "examples": [1523]
    },
    "verification_timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp (UTC) when this chain proof was generated.",
      "examples": ["2025-12-17T14:30:00.000000Z"]
    },
    "integrity_status": {
      "type": "string",
      "description": "Overall integrity status of the chain. VALID = no tampering detected, INVALID = hash mismatch detected, INCOMPLETE = verification could not complete.",
      "enum": ["VALID", "INVALID", "INCOMPLETE"],
      "examples": ["VALID"]
    },
    "verification_method": {
      "type": "string",
      "description": "Method used to verify chain integrity (e.g., 'full-recompute', 'spot-check', 'merkle-proof').",
      "examples": ["full-recompute", "spot-check-sample-100"]
    },
    "sample_records": {
      "type": "array",
      "description": "Optional: Sample of records with their hashes for spot-check verification. Useful for large chains.",
      "items": {
        "type": "object",
        "required": ["record_id", "record_hash", "previous_hash"],
        "properties": {
          "record_id": {"type": "string"},
          "record_hash": {"type": "string", "pattern": "^[a-f0-9]{64}$"},
          "previous_hash": {"type": "string", "pattern": "^[a-f0-9]{64}$"},
          "timestamp": {"type": "string", "format": "date-time"}
        }
      }
    },
    "tamper_evidence": {
      "type": "array",
      "description": "If integrity_status = INVALID, this array contains detected tampering evidence.",
      "items": {
        "type": "object",
        "required": ["record_id", "expected_hash", "actual_hash"],
        "properties": {
          "record_id": {
            "type": "string",
            "description": "ID of the tampered record"
          },
          "expected_hash": {
            "type": "string",
            "pattern": "^[a-f0-9]{64}$",
            "description": "Hash computed from record contents"
          },
          "actual_hash": {
            "type": "string",
            "pattern": "^[a-f0-9]{64}$",
            "description": "Hash stored in the record"
          },
          "detection_method": {
            "type": "string",
            "description": "How tampering was detected (e.g., 'hash-mismatch', 'broken-chain-link')"
          }
        }
      }
    },
    "verifier_identity": {
      "type": "string",
      "description": "Optional: Identity of the entity performing verification (auditor, regulator, third party).",
      "examples": ["independent-auditor-XYZ", "regulatory-authority-ABC"]
    },
    "verifier_signature": {
      "type": "string",
      "description": "Optional: Cryptographic signature of the verifier (implementation-specific format).",
      "examples": ["MEUCIQDxxx..."]
    }
  },
  "additionalProperties": false,
  "$comment": "Chain proofs enable independent verification without accessing the runtime environment. Third parties can validate integrity using only the chain records and this proof structure."
}
